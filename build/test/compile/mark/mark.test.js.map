{"version":3,"file":"mark.test.js","sourceRoot":"","sources":["../../../../test/compile/mark/mark.test.ts"],"names":[],"mappings":"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","sourcesContent":["/* tslint:disable:quotemark */\n\nimport {\n  COLOR,\n  DETAIL,\n  FILLOPACITY,\n  OPACITY,\n  SIZE,\n  STROKEOPACITY,\n  STROKEWIDTH,\n  UNIT_CHANNELS\n} from '../../../src/channel';\nimport {getSort, parseMarkGroups, pathGroupingFields} from '../../../src/compile/mark/mark';\nimport {UnitModel} from '../../../src/compile/unit';\nimport {GEOSHAPE} from '../../../src/mark';\nimport {\n  parseFacetModel,\n  parseUnitModel,\n  parseUnitModelWithScale,\n  parseUnitModelWithScaleAndLayoutSize\n} from '../../util';\n\ndescribe('Mark', () => {\n  describe('parseMarkGroup', () => {\n    // PATH\n    describe('Multi-series Line', () => {\n      const model = parseUnitModelWithScaleAndLayoutSize({\n        mark: {type: 'line', style: 'trend'},\n        encoding: {\n          x: {field: 'date', type: 'temporal', axis: {format: '%Y'}},\n          y: {field: 'price', type: 'quantitative'},\n          color: {field: 'symbol', type: 'nominal'}\n        }\n      });\n      it('should have a facet directive and a nested mark group that uses the faceted data.', () => {\n        const markGroup = parseMarkGroups(model)[0];\n        expect(markGroup.name).toEqual('pathgroup');\n        expect(markGroup.from).toEqual({\n          facet: {\n            name: 'faceted_path_main',\n            data: 'main',\n            groupby: ['symbol']\n          }\n        });\n        const submarkGroup = markGroup.marks[0];\n        expect(submarkGroup.name).toEqual('marks');\n        expect(submarkGroup.type).toEqual('line');\n        expect(submarkGroup.style).toEqual(['line', 'trend']);\n        expect(submarkGroup.from.data).toEqual('faceted_path_main');\n      });\n\n      it('should not have post encoding transform', () => {\n        const markGroup = parseMarkGroups(model)[0];\n        expect(markGroup.name).toEqual('pathgroup');\n        expect(markGroup.from).toEqual({\n          facet: {\n            name: 'faceted_path_main',\n            data: 'main',\n            groupby: ['symbol']\n          }\n        });\n        const submarkGroup = markGroup.marks[0];\n        expect(submarkGroup.transform).not.toBeDefined();\n      });\n    });\n\n    describe('Single Line', () => {\n      const model = parseUnitModelWithScaleAndLayoutSize({\n        mark: 'line',\n        encoding: {\n          x: {field: 'date', type: 'temporal', axis: {format: '%Y'}},\n          y: {field: 'price', type: 'quantitative'}\n        }\n      });\n      it('should have mark group with proper data and key', () => {\n        const markGroup = parseMarkGroups(model)[0];\n        expect(markGroup.name).toEqual('marks');\n        expect(markGroup.type).toEqual('line');\n        expect(markGroup.from.data).toEqual('main');\n      });\n\n      it('should not have post encoding transform', () => {\n        const markGroup = parseMarkGroups(model);\n        expect(markGroup[0].transform).not.toBeDefined();\n      });\n\n      // NON-PATH\n    });\n    describe('Points with key', () => {\n      const model = parseUnitModelWithScaleAndLayoutSize({\n        mark: 'point',\n        encoding: {\n          x: {field: 'date', type: 'temporal', axis: {format: '%Y'}},\n          y: {field: 'price', type: 'quantitative'},\n          key: {field: 'k', type: 'quantitative'}\n        }\n      });\n      it('should have mark group with proper data and key', () => {\n        const markGroup = parseMarkGroups(model)[0];\n        expect(markGroup.type).toEqual('symbol');\n        expect(markGroup.key.field).toEqual('k');\n        expect(markGroup.from.data).toEqual('main');\n      });\n\n      it('should not have post encoding transform', () => {\n        const markGroup = parseMarkGroups(model);\n        expect(markGroup[0].transform).not.toBeDefined();\n      });\n    });\n\n    it('Geoshape should have post encoding transform', () => {\n      const model = parseUnitModelWithScaleAndLayoutSize({\n        mark: 'geoshape',\n        projection: {\n          type: 'albersUsa'\n        },\n        data: {\n          url: 'data/us-10m.json',\n          format: {\n            type: 'topojson',\n            feature: 'states'\n          }\n        },\n        encoding: {}\n      });\n      const markGroup = parseMarkGroups(model);\n      expect(markGroup[0].transform).toBeDefined();\n      expect(markGroup[0].transform[0].type).toEqual(GEOSHAPE);\n    });\n\n    describe('Aggregated Bar with a color with binned x', () => {\n      const model = parseUnitModelWithScaleAndLayoutSize({\n        mark: 'bar',\n        encoding: {\n          x: {type: 'quantitative', field: 'Cost__Other', aggregate: 'sum'},\n          y: {bin: true, type: 'quantitative', field: 'Cost__Total_$'},\n          color: {type: 'ordinal', field: 'Effect__Amount_of_damage'}\n        }\n      });\n      it('should use main stacked data source', () => {\n        const markGroup = parseMarkGroups(model);\n        expect(markGroup[0].from.data).toBe('main');\n        expect(markGroup[0].style).toEqual(['bar']);\n      });\n      it('should not have post encoding transform', () => {\n        const markGroup = parseMarkGroups(model);\n        expect(markGroup[0].transform).not.toBeDefined();\n      });\n    });\n\n    describe('Faceted aggregated Bar with a color with binned x', () => {\n      const model = parseFacetModel({\n        facet: {\n          row: {field: 'a', type: 'nominal'}\n        },\n        spec: {\n          mark: 'bar',\n          encoding: {\n            x: {type: 'quantitative', field: 'Cost__Other', aggregate: 'sum'},\n            y: {bin: true, type: 'quantitative', field: 'Cost__Total_$'},\n            color: {type: 'ordinal', field: 'Effect__Amount_of_damage'}\n          }\n        }\n      });\n      it('should use faceted data source', () => {\n        model.parseScale();\n        model.parseLayoutSize();\n\n        const markGroup = parseMarkGroups(model.child as UnitModel);\n        expect(markGroup[0].from.data).toEqual('child_main');\n      });\n\n      it('should not have post encoding transform', () => {\n        model.parseScale();\n        model.parseLayoutSize();\n\n        const markGroup = parseMarkGroups(model.child as UnitModel);\n        expect(markGroup[0].transform).not.toBeDefined();\n      });\n    });\n\n    describe('Aggregated bar', () => {\n      const model = parseUnitModelWithScaleAndLayoutSize({\n        mark: 'bar',\n        encoding: {\n          x: {type: 'quantitative', field: 'Cost__Other', aggregate: 'sum'},\n          y: {bin: true, type: 'quantitative', field: 'Cost__Total_$'}\n        }\n      });\n\n      it('should use main aggregated data source', () => {\n        const markGroup = parseMarkGroups(model);\n        expect(markGroup[0].from.data).toEqual('main');\n      });\n\n      it('should not have post encoding transform', () => {\n        const markGroup = parseMarkGroups(model);\n        expect(markGroup[0].transform).not.toBeDefined();\n      });\n    });\n  });\n\n  describe('getSort', () => {\n    it('should order by order field', () => {\n      const model = parseUnitModel({\n        data: {url: 'data/driving.json'},\n        mark: 'line',\n        encoding: {\n          x: {field: 'miles', type: 'quantitative', scale: {zero: false}},\n          y: {field: 'gas', type: 'quantitative', scale: {zero: false}},\n          order: {field: 'year', type: 'temporal'}\n        }\n      });\n      expect(getSort(model)).toEqual({\n        field: ['datum[\"year\"]'],\n        order: ['ascending']\n      });\n    });\n\n    it('should have no sort if order = {value: null}', () => {\n      const model = parseUnitModel({\n        data: {url: 'data/driving.json'},\n        mark: 'line',\n        encoding: {\n          x: {field: 'miles', type: 'quantitative', scale: {zero: false}},\n          y: {field: 'gas', type: 'quantitative', scale: {zero: false}},\n          order: {value: null}\n        }\n      });\n      expect(getSort(model)).toEqual(undefined);\n    });\n\n    it('should order by x by default if x is the dimension', () => {\n      const model = parseUnitModelWithScale({\n        data: {url: 'data/movies.json'},\n        mark: 'line',\n        encoding: {\n          x: {\n            bin: {maxbins: 10},\n            field: 'IMDB_Rating',\n            type: 'quantitative'\n          },\n          color: {\n            field: 'Source',\n            type: 'nominal'\n          },\n          y: {\n            aggregate: 'count',\n            type: 'quantitative'\n          }\n        }\n      });\n      expect(getSort(model)).toEqual({\n        field: 'datum[\"bin_maxbins_10_IMDB_Rating\"]',\n        order: 'descending'\n      });\n    });\n\n    it('should not order by a missing dimension', () => {\n      const model = parseUnitModelWithScale({\n        data: {url: 'data/movies.json'},\n        mark: 'line',\n        encoding: {\n          color: {\n            field: 'Source',\n            type: 'nominal'\n          },\n          y: {\n            aggregate: 'count',\n            type: 'quantitative'\n          }\n        }\n      });\n      expect(getSort(model)).toBeUndefined();\n    });\n  });\n\n  describe('pathGroupingFields()', () => {\n    it('should return fields for unaggregate detail, color, size, opacity fieldDefs.', () => {\n      for (const channel of [DETAIL, COLOR, SIZE, OPACITY, FILLOPACITY, STROKEOPACITY, STROKEWIDTH]) {\n        expect(pathGroupingFields('line', {[channel]: {field: 'a', type: 'nominal'}})).toEqual(['a']);\n      }\n    });\n\n    it('should not return a field for size of a trail mark.', () => {\n      expect(pathGroupingFields('trail', {size: {field: 'a', type: 'nominal'}})).toEqual([]);\n    });\n\n    it('should not return fields for aggregate detail, color, size, opacity fieldDefs.', () => {\n      for (const channel of [DETAIL, COLOR, SIZE, OPACITY, FILLOPACITY, STROKEOPACITY, STROKEWIDTH]) {\n        expect(pathGroupingFields('line', {[channel]: {aggregate: 'mean', field: 'a', type: 'nominal'}})).toEqual([]);\n      }\n    });\n\n    it('should return condition detail fields for color, size, shape', () => {\n      for (const channel of [COLOR, SIZE, OPACITY, FILLOPACITY, STROKEOPACITY, STROKEWIDTH]) {\n        expect(\n          pathGroupingFields('line', {\n            [channel]: {\n              condition: {selection: 'sel', field: 'a', type: 'nominal'}\n            }\n          })\n        ).toEqual(['a']);\n      }\n    });\n\n    it('should not return errors for all channels', () => {\n      for (const channel of UNIT_CHANNELS) {\n        expect(() => {\n          pathGroupingFields('line', {\n            [channel]: {field: 'a', type: 'nominal'}\n          });\n        }).not.toThrow();\n      }\n    });\n\n    it('should not include fields from tooltip', () => {\n      expect(pathGroupingFields('line', {tooltip: {field: 'a', type: 'nominal'}})).toEqual([]);\n    });\n  });\n});\n"]}