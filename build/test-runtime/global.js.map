{"version":3,"file":"global.js","sourceRoot":"","sources":["../../test-runtime/global.ts"],"names":[],"mappings":"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","sourcesContent":["import {TopLevelSpec} from './../src/spec/index';\n\nimport {parse, View} from 'vega';\nimport {compile} from '../src';\n\ninterface Opts {\n  bubbles?: boolean;\n  clientX?: number;\n  clientY?: number;\n  shiftKey?: boolean;\n  deltaX?: number;\n  deltaY?: number;\n  deltaZ?: number;\n}\n\nlet view: View;\n\nexport function embed(vlSpec: TopLevelSpec) {\n  const vgSpec = compile(vlSpec).spec;\n  view = new View(parse(vgSpec))\n    .renderer('svg')\n    .initialize('#vis')\n    .run();\n}\n\nconst winSrc = ['mousemove', 'mouseup'];\nexport function mouseEvt(type: string, target: Element | Window, opts?: Opts) {\n  opts.bubbles = true;\n  target = winSrc.indexOf(type) < 0 ? target : window;\n\n  target.dispatchEvent(new MouseEvent('mousemove', {...opts, clientX: opts.clientX - 5, clientY: opts.clientY - 5}));\n\n  target.dispatchEvent(new MouseEvent('mousemove', opts));\n\n  target.dispatchEvent(type === 'wheel' ? new WheelEvent('wheel', opts) : new MouseEvent(type, opts));\n\n  target.dispatchEvent(new MouseEvent('mousemove', {...opts, clientX: opts.clientX + 5, clientY: opts.clientY + 5}));\n}\n\nexport function mark(id: string, parent: string) {\n  return document.querySelector((parent ? `g.${parent} ` : '') + `g.mark-symbol.role-mark path:nth-child(${id})`);\n}\n\nexport function coords(el: Element) {\n  const rect = el.getBoundingClientRect();\n  return [Math.ceil(rect.left + rect.width / 2), Math.ceil(rect.top + rect.height / 2)];\n}\n\nexport function brushOrEl(el: Element, parent: string, _: boolean) {\n  return !_ ? el : document.querySelector((parent ? `g.${parent} ` : '') + 'g.sel_brush > path');\n}\n\nexport function click(el: Element, evt: Opts) {\n  mouseEvt('mousedown', el, evt);\n  mouseEvt('mouseup', window, evt);\n  mouseEvt('click', el, evt);\n}\n\nexport function brush(id0: string, id1: string, parent: string, targetBrush: boolean) {\n  const el0 = mark(id0, parent);\n  const el1 = mark(id1, parent);\n  const [mdX, mdY] = coords(el0);\n  const [muX, muY] = coords(el1);\n  mouseEvt('mousedown', brushOrEl(el0, parent, targetBrush), {clientX: mdX, clientY: mdY});\n  mouseEvt('mouseup', window, {clientX: muX, clientY: muY});\n  return view.data('sel_store');\n}\n\nexport function pt(id: string, parent: string, shiftKey: boolean) {\n  const el = mark(id, parent);\n  const [clientX, clientY] = coords(el);\n  click(el, {clientX, clientY, shiftKey});\n  return view.data('sel_store');\n}\n\nexport function clear(id: string, parent: string, shiftKey: boolean) {\n  const bg = document.querySelector((parent ? `g.${parent} ` : '') + 'path.background');\n  const el = mark(id, parent);\n  let [clientX, clientY] = coords(el);\n  clientX += 10;\n  clientY -= 10;\n  click(bg, {clientX, clientY, shiftKey});\n  return view.data('sel_store');\n}\n\nexport function zoom(id: string, delta: number, parent: string, targetBrush: boolean) {\n  const el = mark(id, parent);\n  const [clientX, clientY] = coords(el);\n  mouseEvt('wheel', brushOrEl(el, parent, targetBrush), {\n    clientX,\n    clientY,\n    deltaX: delta,\n    deltaY: delta,\n    deltaZ: delta\n  });\n  mouseEvt('wheel', brushOrEl(el, parent, targetBrush), {\n    clientX,\n    clientY,\n    deltaX: Math.sign(delta),\n    deltaY: Math.sign(delta),\n    deltaZ: Math.sign(delta)\n  });\n  return view.data('sel_store');\n}\n\n// window['embed'] = embed;\n// window['click'] = click;\n// window['brush'] = brush;\n// window['pt'] = pt;\n// window['clear'] = clear;\n// window['zoom'] = zoom;\n"]}